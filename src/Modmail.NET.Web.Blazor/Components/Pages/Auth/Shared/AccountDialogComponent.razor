@using Modmail.NET.Web.Blazor.Extensions
@using Modmail.NET.Web.Blazor.Providers
@inject NavigationManager NavigationManager
@attribute [AuthorizeTeam]

@code {

  [CascadingParameter]
  public required Task<AuthenticationState> AuthContext { get; set; }

  private ulong _userId;
  private string _username = string.Empty;


  protected override async Task OnInitializedAsync() {
    var auth = await AuthContext;
    _userId = auth.User.GetUserId();
    _username = auth.User.GetUsername();
    var roleStr = auth.User.GetRole();
    if (string.IsNullOrEmpty(roleStr)) {
      NavigationManager.NavigateTo("result/" + Lang.UnauthorizedAccess);
    }
  }

  private void ClickLogout() {
    NavigationManager.NavigateTo("/auth/logout", true);
  }
}



<RadzenRow>
  <RadzenColumn Size="12">
    <RadzenRow class="rz-my-4">
      <RadzenColumn>
        <RadzenLabel>@Lang.DiscordUserId</RadzenLabel>
      </RadzenColumn>
      <RadzenColumn>
        @_userId.ToString()
      </RadzenColumn>
    </RadzenRow>


    <RadzenRow class="rz-my-4">
      <RadzenColumn>
        <RadzenLabel>@Lang.DiscordUsername.Translate()</RadzenLabel>
      </RadzenColumn>
      <RadzenColumn>
        @_username
      </RadzenColumn>
    </RadzenRow>


    <RadzenRow class="rz-my-4 rz-pt-4">
      <RadzenButton ButtonType="ButtonType.Button"
                    Text="@Lang.Logout.Translate()"
                    Icon="logout"
                    Click="ClickLogout"
                    ButtonStyle="ButtonStyle.Warning"/>
    </RadzenRow>
  </RadzenColumn>
</RadzenRow>
